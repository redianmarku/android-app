{"version":3,"sources":["../../src/core/mainmenu/pages/menu/menu.module.ts","../../src/core/mainmenu/pages/menu/menu.ts"],"names":[],"mappings":"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","file":"34.js","sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreMainMenuPage } from './menu';\n\n@NgModule({\n    declarations: [\n        CoreMainMenuPage,\n    ],\n    imports: [\n        CoreComponentsModule,\n        IonicPageModule.forChild(CoreMainMenuPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class CoreMainMenuPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/mainmenu/pages/menu/menu.module.ts","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, OnDestroy, ViewChild, ChangeDetectorRef } from '@angular/core';\nimport { IonicPage, NavController, NavParams, Platform } from 'ionic-angular';\nimport { CoreAppProvider } from '@providers/app';\nimport { CoreSitesProvider } from '@providers/sites';\nimport { CoreEventsProvider } from '@providers/events';\nimport { CoreIonTabsComponent } from '@components/ion-tabs/ion-tabs';\nimport { CoreMainMenuProvider } from '../../providers/mainmenu';\nimport { CoreMainMenuDelegate, CoreMainMenuHandlerToDisplay } from '../../providers/delegate';\nimport { CoreContentLinksDelegate } from '@core/contentlinks/providers/delegate';\nimport { CoreContentLinksHelperProvider } from '@core/contentlinks/providers/helper';\n\n/**\n * Page that displays the main menu of the app.\n */\n@IonicPage({segment: 'core-mainmenu'})\n@Component({\n    selector: 'page-core-mainmenu',\n    templateUrl: 'menu.html',\n})\nexport class CoreMainMenuPage implements OnDestroy {\n    tabs: CoreMainMenuHandlerToDisplay[] = [];\n    allHandlers: CoreMainMenuHandlerToDisplay[];\n    loaded = false;\n    redirectPage: string;\n    redirectParams: any;\n    showTabs = false;\n    tabsPlacement = 'bottom';\n\n    protected subscription;\n    protected redirectObs: any;\n    protected pendingRedirect: any;\n    protected urlToOpen: string;\n    protected mainMenuId: number;\n    protected keyboardObserver: any;\n\n    @ViewChild('mainTabs') mainTabs: CoreIonTabsComponent;\n\n    constructor(protected menuDelegate: CoreMainMenuDelegate,\n            protected sitesProvider: CoreSitesProvider,\n            navParams: NavParams,\n            protected navCtrl: NavController,\n            protected eventsProvider: CoreEventsProvider,\n            protected cdr: ChangeDetectorRef,\n            protected mainMenuProvider: CoreMainMenuProvider,\n            protected linksDelegate: CoreContentLinksDelegate,\n            protected linksHelper: CoreContentLinksHelperProvider,\n            protected appProvider: CoreAppProvider,\n            protected platform: Platform) {\n\n        this.mainMenuId = this.appProvider.getMainMenuId();\n\n        // Check if the menu was loaded with a redirect.\n        const redirectPage = navParams.get('redirectPage');\n        if (redirectPage) {\n            this.pendingRedirect = {\n                redirectPage: redirectPage,\n                redirectParams: navParams.get('redirectParams')\n            };\n        }\n\n        this.urlToOpen = navParams.get('urlToOpen');\n    }\n\n    /**\n     * View loaded.\n     */\n    ionViewDidLoad(): void {\n        if (!this.sitesProvider.isLoggedIn()) {\n            this.navCtrl.setRoot('CoreLoginInitPage');\n\n            return;\n        }\n\n        this.showTabs = true;\n\n        this.redirectObs = this.eventsProvider.on(CoreEventsProvider.LOAD_PAGE_MAIN_MENU, (data) => {\n            if (!this.loaded) {\n                // View isn't ready yet, wait for it to be ready.\n                this.pendingRedirect = data;\n            } else {\n                delete this.pendingRedirect;\n                this.handleRedirect(data);\n            }\n        });\n\n        this.subscription = this.menuDelegate.getHandlers().subscribe((handlers) => {\n            // Remove the handlers that should only appear in the More menu.\n            this.allHandlers = handlers.filter((handler) => {\n                return !handler.onlyInMore;\n            });\n\n            this.initHandlers();\n\n            if (this.loaded && this.pendingRedirect) {\n                // Wait for tabs to be initialized and then handle the redirect.\n                setTimeout(() => {\n                    if (this.pendingRedirect) {\n                        this.handleRedirect(this.pendingRedirect);\n                        delete this.pendingRedirect;\n                    }\n                });\n            }\n        });\n\n        window.addEventListener('resize', this.initHandlers.bind(this));\n\n        if (this.platform.is('ios')) {\n            // In iOS, the resize event is triggered before the keyboard is opened/closed and not triggered again once done.\n            // Init handlers again once keyboard is closed since the resize event doesn't have the updated height.\n            this.keyboardObserver = this.eventsProvider.on(CoreEventsProvider.KEYBOARD_CHANGE, (kbHeight) => {\n                if (kbHeight === 0) {\n                    this.initHandlers();\n\n                    // If the device is slow it can take a bit more to update the window height. Retry in a few ms.\n                    setTimeout(() => {\n                        this.initHandlers();\n                    }, 250);\n                }\n            });\n        }\n\n        this.appProvider.setMainMenuOpen(this.mainMenuId, true);\n    }\n\n    /**\n     * Init handlers on change (size or handlers).\n     */\n    initHandlers(): void {\n        if (this.allHandlers) {\n            this.tabsPlacement = this.mainMenuProvider.getTabPlacement(this.navCtrl);\n\n            const handlers = this.allHandlers.slice(0, this.mainMenuProvider.getNumItems()); // Get main handlers.\n\n            // Re-build the list of tabs. If a handler is already in the list, use existing object to prevent re-creating the tab.\n            const newTabs = [];\n\n            for (let i = 0; i < handlers.length; i++) {\n                const handler = handlers[i];\n\n                // Check if the handler is already in the tabs list. If so, use it.\n                const tab = this.tabs.find((tab) => {\n                    return tab.title == handler.title && tab.icon == handler.icon;\n                });\n\n                tab ? tab.hide = false : null;\n                handler.hide = false;\n\n                newTabs.push(tab || handler);\n            }\n\n            // Maintain tab in phantom mode in case is not visible.\n            const selectedTab = this.mainTabs.getSelected();\n            if (selectedTab) {\n                const oldTab = this.tabs.find((tab) => {\n                    return tab.page == selectedTab.root && tab.icon == selectedTab.tabIcon;\n                });\n\n                if (oldTab) {\n                    // Check if the selected handler is visible.\n                    const isVisible = newTabs.some((newTab) => {\n                        return oldTab.title == newTab.title && oldTab.icon == newTab.icon;\n                    });\n\n                    if (!isVisible) {\n                        oldTab.hide = true;\n                        newTabs.push(oldTab);\n                    }\n                }\n            }\n\n            this.tabs = newTabs;\n\n            // Sort them by priority so new handlers are in the right position.\n            this.tabs.sort((a, b) => {\n                return b.priority - a.priority;\n            });\n\n            this.loaded = this.menuDelegate.areHandlersLoaded();\n        }\n\n        if (this.urlToOpen) {\n            // There's a content link to open.\n            const url = this.urlToOpen;\n            delete this.urlToOpen;\n\n            this.linksDelegate.getActionsFor(url, undefined).then((actions) => {\n                const action = this.linksHelper.getFirstValidAction(actions);\n                if (action && action.sites.length) {\n                    // Action should only have 1 site because we're filtering by username.\n                    action.action(action.sites[0]);\n                }\n            });\n        }\n    }\n\n    /**\n     * Handle a redirect.\n     *\n     * @param data Data received.\n     */\n    protected handleRedirect(data: any): void {\n        // Check if the redirect page is the root page of any of the tabs.\n        const i = this.tabs.findIndex((tab, i) => {\n            return tab.page == data.redirectPage;\n        });\n\n        if (i >= 0) {\n            // Tab found. Set the params.\n            this.tabs[i].pageParams = Object.assign({}, data.redirectParams);\n        } else {\n            // Tab not found, use a phantom tab.\n            this.redirectPage = data.redirectPage;\n            this.redirectParams = data.redirectParams;\n        }\n\n        // Force change detection, otherwise sometimes the tab was selected before the params were applied.\n        this.cdr.detectChanges();\n\n        setTimeout(() => {\n            // Let the tab load the params before navigating.\n            this.mainTabs.selectTabRootByIndex(i + 1);\n        });\n    }\n\n    /**\n     * Page destroyed.\n     */\n    ngOnDestroy(): void {\n        this.subscription && this.subscription.unsubscribe();\n        this.redirectObs && this.redirectObs.off();\n        window.removeEventListener('resize', this.initHandlers.bind(this));\n        this.appProvider.setMainMenuOpen(this.mainMenuId, false);\n        this.keyboardObserver && this.keyboardObserver.off();\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/core/mainmenu/pages/menu/menu.ts"],"sourceRoot":""}