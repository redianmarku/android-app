{"version":3,"sources":["../../src/addon/mod/glossary/pages/entry/entry.module.ts","../../src/addon/mod/glossary/pages/entry/entry.ts"],"names":[],"mappings":"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","file":"99.js","sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreDirectivesModule } from '@directives/directives.module';\nimport { CorePipesModule } from '@pipes/pipes.module';\nimport { CoreCommentsComponentsModule } from '@core/comments/components/components.module';\nimport { CoreRatingComponentsModule } from '@core/rating/components/components.module';\nimport { CoreTagComponentsModule } from '@core/tag/components/components.module';\nimport { AddonModGlossaryEntryPage } from './entry';\n\n@NgModule({\n    declarations: [\n        AddonModGlossaryEntryPage,\n    ],\n    imports: [\n        CoreComponentsModule,\n        CoreDirectivesModule,\n        CorePipesModule,\n        IonicPageModule.forChild(AddonModGlossaryEntryPage),\n        TranslateModule.forChild(),\n        CoreCommentsComponentsModule,\n        CoreRatingComponentsModule,\n        CoreTagComponentsModule\n    ],\n})\nexport class AddonModForumDiscussionPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/glossary/pages/entry/entry.module.ts","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, ViewChild } from '@angular/core';\nimport { IonicPage, NavParams } from 'ionic-angular';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { CoreRatingInfo } from '@core/rating/providers/rating';\nimport { CoreTagProvider } from '@core/tag/providers/tag';\nimport { CoreCommentsProvider } from '@core/comments/providers/comments';\nimport { CoreCommentsCommentsComponent } from '@core/comments/components/comments/comments';\nimport { AddonModGlossaryProvider } from '../../providers/glossary';\n\n/**\n * Page that displays a glossary entry.\n */\n@IonicPage({ segment: 'addon-mod-glossary-entry' })\n@Component({\n    selector: 'page-addon-mod-glossary-entry',\n    templateUrl: 'entry.html',\n})\nexport class AddonModGlossaryEntryPage {\n    @ViewChild(CoreCommentsCommentsComponent) comments: CoreCommentsCommentsComponent;\n\n    component = AddonModGlossaryProvider.COMPONENT;\n    componentId: number;\n    entry: any;\n    glossary: any;\n    loaded = false;\n    showAuthor = false;\n    showDate = false;\n    ratingInfo: CoreRatingInfo;\n    tagsEnabled: boolean;\n    commentsEnabled: boolean;\n\n    protected courseId: number;\n    protected entryId: number;\n\n    constructor(navParams: NavParams,\n            protected domUtils: CoreDomUtilsProvider,\n            protected glossaryProvider: AddonModGlossaryProvider,\n            protected tagProvider: CoreTagProvider,\n            protected commentsProvider: CoreCommentsProvider) {\n        this.courseId = navParams.get('courseId');\n        this.entryId = navParams.get('entryId');\n    }\n\n    /**\n     * View loaded.\n     */\n    ionViewDidLoad(): void {\n        this.tagsEnabled = this.tagProvider.areTagsAvailableInSite();\n        this.commentsEnabled = !this.commentsProvider.areCommentsDisabledInSite();\n\n        this.fetchEntry().then(() => {\n            this.glossaryProvider.logEntryView(this.entry.id, this.componentId, this.glossary.name).catch(() => {\n                // Ignore errors.\n            });\n        }).finally(() => {\n            this.loaded = true;\n        });\n    }\n\n    /**\n     * Refresh the data.\n     *\n     * @param refresher Refresher.\n     * @return Promise resolved when done.\n     */\n     doRefresh(refresher?: any): Promise<any> {\n        if (this.glossary && this.glossary.allowcomments && this.entry && this.entry.id > 0 && this.commentsEnabled &&\n                this.comments) {\n            // Refresh comments. Don't add it to promises because we don't want the comments fetch to block the entry fetch.\n            this.comments.doRefresh().catch(() => {\n                // Ignore errors.\n            });\n        }\n\n        return this.glossaryProvider.invalidateEntry(this.entry.id).catch(() => {\n            // Ignore errors.\n        }).then(() => {\n            return this.fetchEntry(true);\n        }).finally(() => {\n            refresher && refresher.complete();\n        });\n    }\n\n    /**\n     * Convenience function to get the glossary entry.\n     *\n     * @param refresh Whether we're refreshing data.\n     * @return Promise resolved when done.\n     */\n    protected fetchEntry(refresh?: boolean): Promise<any> {\n        return this.glossaryProvider.getEntry(this.entryId).then((result) => {\n            this.entry = result.entry;\n            this.ratingInfo = result.ratinginfo;\n\n            if (!refresh) {\n                // Load the glossary.\n                return this.glossaryProvider.getGlossaryById(this.courseId, this.entry.glossaryid).then((glossary) => {\n                    this.glossary = glossary;\n                    this.componentId = glossary.coursemodule;\n\n                    switch (glossary.displayformat) {\n                        case 'fullwithauthor':\n                        case 'encyclopedia':\n                            this.showAuthor = true;\n                            this.showDate = true;\n                            break;\n                        case 'fullwithoutauthor':\n                            this.showAuthor = false;\n                            this.showDate = true;\n                            break;\n                        default: // Default, and faq, simple, entrylist, continuous.\n                            this.showAuthor = false;\n                            this.showDate = false;\n                    }\n                });\n            }\n        }).catch((error) => {\n            this.domUtils.showErrorModalDefault(error, 'addon.mod_glossary.errorloadingentry', true);\n\n            return Promise.reject(null);\n        });\n    }\n\n    /**\n     * Function called when rating is updated online.\n     */\n    ratingUpdated(): void {\n        this.glossaryProvider.invalidateEntry(this.entryId);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/glossary/pages/entry/entry.ts"],"sourceRoot":""}