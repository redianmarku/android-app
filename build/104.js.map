{"version":3,"sources":["../../src/addon/mod/forum/pages/edit-post/edit-post.module.ts","../../src/addon/mod/forum/pages/edit-post/edit-post.ts"],"names":[],"mappings":"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","file":"104.js","sourcesContent":["// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { CoreComponentsModule } from '@components/components.module';\nimport { CoreDirectivesModule } from '@directives/directives.module';\nimport { AddonModForumComponentsModule } from '../../components/components.module';\nimport { AddonModForumEditPostPage } from './edit-post';\nimport { CoreEditorComponentsModule } from '@core/editor/components/components.module';\n\n@NgModule({\n    declarations: [\n        AddonModForumEditPostPage,\n    ],\n    imports: [\n        CoreComponentsModule,\n        CoreDirectivesModule,\n        AddonModForumComponentsModule,\n        CoreEditorComponentsModule,\n        IonicPageModule.forChild(AddonModForumEditPostPage),\n        TranslateModule.forChild()\n    ],\n})\nexport class AddonModForumEditPostPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/forum/pages/edit-post/edit-post.module.ts","// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Component, ViewChild, ElementRef } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { IonicPage, ViewController, NavParams } from 'ionic-angular';\nimport { TranslateService } from '@ngx-translate/core';\nimport { CoreFileUploaderProvider } from '@core/fileuploader/providers/fileuploader';\nimport { CoreSitesProvider } from '@providers/sites';\nimport { CoreDomUtilsProvider } from '@providers/utils/dom';\nimport { AddonModForumProvider } from '../../providers/forum';\nimport { AddonModForumHelperProvider } from '../../providers/helper';\n\n/**\n * Page that displays a form to edit discussion post.\n */\n@IonicPage({ segment: 'addon-mod-edit-post' })\n@Component({\n    selector: 'addon-mod-forum-edit-post',\n    templateUrl: 'addon-mod-forum-edit-post.html',\n})\nexport class AddonModForumEditPostPage {\n    @ViewChild('editFormEl') formElement: ElementRef;\n\n    component: string; // Component this post belong to.\n    componentId: number; // Component ID.\n    forum: any; // The forum the post belongs to. Required for attachments and offline posts.\n\n    messageControl = new FormControl();\n    advanced = false; // Display all form fields.\n    replyData: any = {};\n    originalData: any = {}; // Object with the original post data. Usually shared between posts.\n\n    protected forceLeave = false; // To allow leaving the page without checking for changes.\n\n    constructor(\n            params: NavParams,\n            protected forumProvider: AddonModForumProvider,\n            protected viewCtrl: ViewController,\n            protected domUtils: CoreDomUtilsProvider,\n            protected uploaderProvider: CoreFileUploaderProvider,\n            protected forumHelper: AddonModForumHelperProvider,\n            protected translate: TranslateService,\n            protected sitesProvider: CoreSitesProvider) {\n\n        const post = params.get('post');\n        this.component = params.get('component');\n        this.componentId = params.get('componentId');\n        this.forum = params.get('forum');\n\n        this.replyData.id = post.id;\n        this.replyData.subject = post.subject;\n        this.replyData.message = post.message;\n        this.replyData.files = post.attachments || [];\n\n        // Delete the local files from the tmp folder if any.\n        this.uploaderProvider.clearTmpFiles(this.replyData.files);\n\n        // Update rich text editor.\n        this.messageControl.setValue(this.replyData.message);\n\n        // Update original data.\n        this.originalData.subject = this.replyData.subject;\n        this.originalData.message = this.replyData.message;\n        this.originalData.files = this.replyData.files.slice();\n\n        // Show advanced fields if any of them has not the default value.\n        this.advanced = this.replyData.files.length > 0;\n    }\n\n    /**\n     * Check if we can leave the page or not.\n     *\n     * @return Resolved if we can leave it, rejected if not.\n     */\n    ionViewCanLeave(): boolean | Promise<void> {\n        if (this.forceLeave) {\n            return true;\n        }\n\n        let promise: any;\n\n        if (this.forumHelper.hasPostDataChanged(this.replyData, this.originalData)) {\n            // Show confirmation if some data has been modified.\n            promise = this.domUtils.showConfirm(this.translate.instant('core.confirmcanceledit'));\n        } else {\n            promise = Promise.resolve();\n        }\n\n        return promise.then(() => {\n            // Delete the local files from the tmp folder.\n            this.uploaderProvider.clearTmpFiles(this.replyData.files);\n        });\n    }\n\n    /**\n     * Message changed.\n     *\n     * @param text The new text.\n     */\n    onMessageChange(text: string): void {\n        this.replyData.message = text;\n    }\n\n    /**\n     * Close modal.\n     *\n     * @param data Data to return to the page.\n     */\n    closeModal(data: any, ): void {\n        if (data) {\n            this.domUtils.triggerFormSubmittedEvent(this.formElement, false, this.sitesProvider.getCurrentSiteId());\n        } else {\n            this.domUtils.triggerFormCancelledEvent(this.formElement, this.sitesProvider.getCurrentSiteId());\n        }\n\n        this.viewCtrl.dismiss(data);\n    }\n\n    /**\n     * Reply to this post.\n     *\n     * @param e Click event.\n     */\n    reply(e: Event): void {\n        e.preventDefault();\n        e.stopPropagation();\n\n        // Close the modal, sending the input data.\n        this.forceLeave = true;\n        this.closeModal(this.replyData);\n    }\n\n    /**\n     * Show or hide advanced form fields.\n     */\n    toggleAdvanced(): void {\n        this.advanced = !this.advanced;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/addon/mod/forum/pages/edit-post/edit-post.ts"],"sourceRoot":""}