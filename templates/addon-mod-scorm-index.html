<core-navbar-buttons end><core-context-menu><core-context-menu-item *ngIf="externalUrl" [priority]="900" [content]="'core.openinbrowser' | translate" [href]="externalUrl" [iconAction]="'open'"></core-context-menu-item><core-context-menu-item *ngIf="description" [priority]="800" [content]="'core.moduleintro' | translate" (action)="expandDescription()" [iconAction]="'arrow-forward'"></core-context-menu-item><core-context-menu-item *ngIf="blog" [priority]="750" content="{{'addon.blog.blog' | translate}}" [iconAction]="'fa-newspaper-o'" (action)="gotoBlog($event)"></core-context-menu-item><core-context-menu-item *ngIf="loaded && !hasOffline && isOnline" [priority]="700" [content]="'core.refresh' | translate" (action)="doRefresh(null, $event)" [iconAction]="refreshIcon" [closeOnClick]="false"></core-context-menu-item><core-context-menu-item *ngIf="loaded && hasOffline && isOnline" [priority]="600" [content]="'core.settings.synchronizenow' | translate" (action)="doRefresh(null, $event, true)" [iconAction]="syncIcon" [closeOnClick]="false"></core-context-menu-item><core-context-menu-item *ngIf="prefetchStatusIcon" [priority]="500" [content]="prefetchText" (action)="prefetch($event)" [iconAction]="prefetchStatusIcon" [closeOnClick]="false"></core-context-menu-item><core-context-menu-item *ngIf="size" [priority]="400" [content]="'core.removefiles' | translate:{$a: size}" [iconDescription]="'cube'" (action)="removeFiles($event)" [iconAction]="'trash'" [closeOnClick]="false"></core-context-menu-item></core-context-menu></core-navbar-buttons><core-loading [hideUntil]="loaded" class="core-loading-center"><core-course-module-description [description]="description" [component]="component" [componentId]="componentId" contextLevel="module" [contextInstanceId]="module.id" [courseId]="courseId"></core-course-module-description><div *ngIf="scorm && scorm.warningMessage" class="core-info-card" icon-start><ion-icon name="information-circle"></ion-icon>{{ scorm.warningMessage }}</div><div *ngIf="scorm && loaded && !scorm.warningMessage"><ion-card *ngIf="(scorm.displayattemptstatus || (scorm.offlineAttempts && scorm.offlineAttempts.length)) && !skip"><ion-card-header text-wrap><div class="safe-padding-horizontal"><h2>{{ 'addon.mod_scorm.attempts' | translate }}</h2></div></ion-card-header><ion-list><ng-container *ngIf="scorm.displayattemptstatus"><ion-item text-wrap *ngIf="scorm.maxattempt >= 0"><h3>{{ 'addon.mod_scorm.noattemptsallowed' | translate }}</h3><p item-content *ngIf="scorm.maxattempt == 0">{{ 'core.unlimited' | translate }}</p><p item-content *ngIf="scorm.maxattempt > 0">{{ scorm.maxattempt }}</p></ion-item><ion-item text-wrap *ngIf="scorm.numAttempts >= 0"><h3>{{ 'addon.mod_scorm.noattemptsmade' | translate }}</h3><p item-content>{{ scorm.numAttempts }}</p></ion-item><ion-item text-wrap *ngFor="let attempt of scorm.onlineAttempts"><h3>{{ 'addon.mod_scorm.gradeforattempt' | translate }} {{attempt.number}}</h3><p item-content *ngIf="attempt.grade != -1">{{ attempt.grade }}</p><p item-content *ngIf="attempt.grade == -1">{{ 'addon.mod_scorm.cannotcalculategrade' | translate }}</p></ion-item></ng-container><ion-item text-wrap *ngFor="let attempt of scorm.offlineAttempts"><h3>{{ 'addon.mod_scorm.gradeforattempt' | translate }} {{attempt.number}}</h3><p item-content *ngIf="attempt.grade != -1">{{ attempt.grade }}</p><p item-content *ngIf="attempt.grade == -1">{{ 'addon.mod_scorm.cannotcalculategrade' | translate }}</p><p *ngIf="scorm.maxattempt == 0 || attempt.number <= scorm.maxattempt">{{ 'addon.mod_scorm.offlineattemptnote' | translate }}</p><p *ngIf="scorm.maxattempt != 0 && attempt.number > scorm.maxattempt">{{ 'addon.mod_scorm.offlineattemptovermax' | translate }}</p></ion-item><ion-item text-wrap *ngIf="scorm.displayattemptstatus && scorm.gradeMethodReadable"><h3>{{ 'addon.mod_scorm.grademethod' | translate }}</h3><p item-content>{{ scorm.gradeMethodReadable }}</p></ion-item><ion-item text-wrap *ngIf="scorm.displayattemptstatus && scorm.grade"><h3>{{ 'addon.mod_scorm.gradereported' | translate }}</h3><p item-content *ngIf="scorm.grade != -1">{{ scorm.grade }}</p><p item-content *ngIf="scorm.grade == -1">{{ 'addon.mod_scorm.cannotcalculategrade' | translate }}</p></ion-item><ion-item text-wrap *ngIf="syncTime"><h3>{{ 'core.lastsync' | translate }}</h3><p>{{ syncTime }}</p></ion-item></ion-list></ion-card><div class="core-warning-card" icon-start *ngIf="!errorMessage && hasOffline"><ion-icon name="warning"></ion-icon>{{ 'core.hasdatatosync' | translate: {$a: moduleName} }}</div><ion-card *ngIf="scorm && organizations && ((scorm.displaycoursestructure && organizations.length) || organizations.length > 1) && !skip" class="addon-mod_scorm-toc"><ion-card-header text-wrap><h2>{{ 'addon.mod_scorm.contents' | translate }}</h2></ion-card-header><ion-list><ion-item text-wrap *ngIf="organizations.length > 1"><ion-label>{{ 'addon.mod_scorm.organizations' | translate }}</ion-label><ion-select [(ngModel)]="currentOrganization.identifier" (ionChange)="loadOrganization()" interface="action-sheet"><ion-option *ngFor="let org of organizations" [value]="org.identifier">{{ org.title }}</ion-option></ion-select></ion-item><ion-item text-center *ngIf="scorm.displaycoursestructure && loadingToc"><ion-spinner></ion-spinner></ion-item><ion-item text-wrap *ngIf="scorm.displaycoursestructure && !loadingToc"><p *ngIf="attemptToContinue">{{ 'addon.mod_scorm.dataattemptshown' | translate:{number: attemptToContinue} }}</p><p>{{ currentOrganization.title }}</p><div *ngFor="let sco of toc" class="core-padding-{{sco.level}} addon-mod_scorm-type-{{sco.scormtype}}"><p *ngIf="sco.isvisible"><core-icon [name]="sco.image.icon" [label]="sco.image.description" item-start></core-icon><a *ngIf="sco.prereq && sco.launch" (click)="open($event, false, sco.id)" class="core-clickable"><core-format-text [text]="sco.title" contextLevel="module" [contextInstanceId]="module.id" [courseId]="courseId"></core-format-text></a><span *ngIf="!sco.prereq || !sco.launch"><core-format-text [text]="sco.title" contextLevel="module" [contextInstanceId]="module.id" [courseId]="courseId"></core-format-text></span><span *ngIf="accessInfo && accessInfo.canviewscores && sco.score_raw">({{ 'addon.mod_scorm.score' | translate }}: {{sco.score_raw}})</span></p></div></ion-item></ion-list></ion-card><ion-card *ngIf="errorMessage"><ion-item text-wrap><p class="text-danger">{{ errorMessage | translate }}</p></ion-item><ion-item text-wrap><a ion-button block icon-end [href]="externalUrl" core-link>{{ 'core.openinbrowser' | translate }}<ion-icon name="open"></ion-icon></a></ion-item></ion-card><ion-card *ngIf="!errorMessage && scorm && scorm.attemptsLeft <= 0"><ion-item text-wrap><p class="text-danger">{{ 'addon.mod_scorm.exceededmaxattempts' | translate }}</p></ion-item></ion-card><ion-card *ngIf="!errorMessage && scorm && (!scorm.lastattemptlock || scorm.attemptsLeft > 0)"><ion-list><ng-container *ngIf="!downloading && !skip"><ion-item text-wrap *ngIf="!scorm.forcenewattempt && scorm.numAttempts > 0 && !scorm.incomplete && scorm.attemptsLeft > 0"><ion-label>{{ 'addon.mod_scorm.newattempt' | translate }}</ion-label><ion-checkbox item-end name="newAttempt" [(ngModel)]="startNewAttempt"></ion-checkbox></ion-item><ion-item text-wrap *ngIf="statusMessage"><p>{{ statusMessage | translate }}</p></ion-item><ion-grid><ion-row align-items-center><ion-col col-12 col-sm-6 *ngIf="!scorm.hidebrowse"><button ion-button block outline icon-end (click)="open($event, true)" text-wrap>{{ 'addon.mod_scorm.browse' | translate }}<ion-icon name="search"></ion-icon></button></ion-col><ion-col col-12 [attr.col-sm-6]="!scorm.hidebrowse || null"><button ion-button block icon-end (click)="open($event)" text-wrap>{{ 'addon.mod_scorm.enter' | translate }}<ion-icon name="arrow-forward"></ion-icon></button></ion-col></ion-row></ion-grid></ng-container><ion-item text-center *ngIf="downloading"><ion-spinner></ion-spinner><h2 *ngIf="progressMessage">{{ progressMessage | translate }}</h2><core-progress-bar *ngIf="percentage <= 100" [progress]="percentage"></core-progress-bar></ion-item></ion-list></ion-card></div></core-loading>